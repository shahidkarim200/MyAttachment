<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta charset="UTF-8">
    <title>Attachment Style Questionnaire</title>
    <link href="https://fonts.googleapis.com/css2?family=Hanken+Grotesk&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FFF9F3;
            color: #080A47;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 20px;
            overflow-x: hidden;
            min-height: 100vh;
            margin: 0;
            position: relative;
        }

        .header {
            font-family: 'Inter', sans-serif;
            font-size: 24px;
            font-weight: 700;
            color: #080a47;
            position: absolute;
            top: 20px;
            left: 25%;
        }

        .container {
            max-width: 800px;
            width: 100%;
            background-color: #FFF9F3;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            position: relative;
            text-align: center;
            z-index: 1;
        }

        h1 {
            font-family: 'Hanken Grotesk', sans-serif;
            font-size: 2em;
            text-align: center;
            color: #080A47;
        }

        form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .question {
        text-align: center;
        margin-bottom: 20px;
    }

    .question p {
        font-size: 1.2em;
        margin-bottom: 20px;
    }

    .options-container {
    width: 100%;
    max-width: 300px;
    margin: 0 auto;
}

.option {
    width: 100%;
}

    .option input[type="radio"] {
        display: none;
    }

    .option label {
        font-size: 1em;
        padding: 10px 20px;
        border: 2px solid #080A47;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s, transform 0.3s;
        display: block;
        width: 100%;
        text-align: center; /* Center-align text within labels */
    }

        .option input[type="radio"]:checked + label,
        .option label:hover {
            background-color: #080A47;
            color: #FFF9F3;
            transform: scale(1.05);
        }

        .submit-container {
            text-align: center;
            display: flex;
            justify-content: center;
            gap: 40px;
        }

        .submit-container input[type="submit"],
        .submit-container button {
            font-size: 1.2em;
            padding: 10px 20px;
            color: #FFF9F3;
            background-color: #080A47;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
        }

        .submit-container input[type="submit"]:hover,
        .submit-container button:hover {
            background-color: #1a1c7a;
            transform: scale(1.05);
        }

        #progressBar {
            width: 100%;
            height: 10px;
            background-color: #ddd;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        #progressBar::before {
            content: '';
            display: block;
            height: 100%;
            background-color: #080A47;
            border-radius: 5px;
            width: 0%;
            transition: width 0.3s ease;
        }

        .floating-image-top {
            position: absolute;
            top: -150px;
            right: -150px;
            width: 50vw;
            height: auto;
            animation: floatImage 3s ease-in-out infinite;
            transform: rotate(15deg);
            z-index: 0;
        }

        .floating-image-bottom {
            position: absolute;
            bottom: -150px;
            left: -150px;
            width: 50vw;
            height: auto;
            animation: floatImage 3s ease-in-out infinite;
            transform: rotate(-15deg);
            z-index: 0;
        }

        @keyframes floatImage {
            0%, 100% {
                transform: translateY(0) rotate(15deg);
            }
            50% {
                transform: translateY(-10px) rotate(15deg);
            }
        }

        @media (max-width: 768px) {
            .header {
                left: 50%;
                transform: translateX(-50%);
            }
            .floating-image-top,
            .floating-image-bottom {
                width: 70vw;
            }
        }

        @media (max-width: 480px) {
            .floating-image-top,
            .floating-image-bottom {
                width: 80vw;
            }
        }
ul {
    list-style-type: none;
    padding: 0;
}

li {
    margin-bottom: 10px;
}
.cta-button {
    background-color: #3A30BA;
    color: white;
    font-family: 'Inter', sans-serif;
    font-size: 16px;
    padding: 10px 20px;
    border: none;
    border-radius: 20px;
    cursor: pointer;
    display: block;
    margin: 20px auto;
    transition: background-color 0.3s ease;
}

.cta-button:hover {
    background-color: #2A2090;
}

.secondary-button {
    background-color: #f0f0f0;
    color: #333;
    font-family: 'Inter', sans-serif;
    font-size: 14px;
    padding: 8px 16px;
    border: 1px solid #ccc;
    border-radius: 15px;
    cursor: pointer;
    display: block;
    margin: 10px auto;
    transition: background-color 0.3s ease;
}

.secondary-button:hover {
    background-color: #e0e0e0;
}

.question {
    transition: opacity 0.3s ease;
}
@media (max-width: 768px) {
    body {
        font-size: 16px;
        padding: 10px;
        overflow-x: hidden;
    }

    .header {
        font-size: 22px;
        top: 10px;
        left: 50%;
        transform: translateX(-50%);
        width: 100%;
        text-align: center;
    }

    .container {
        width: 95%;
        max-width: none;
        margin: 60px auto 20px;
        padding: 15px;
        box-sizing: border-box;
    }

    h1 {
        font-size: 1.8em;
    }

    .question p {
        font-size: 1.1em;
    }

    .option label {
        font-size: 1em;
        padding: 10px 15px;
    }

    .submit-container input[type="submit"],
    .submit-container button {
        font-size: 1.1em;
        padding: 10px 20px;
    }

    .floating-image-top {
        top: -50px;
        right: -50px;
        width: 60vw;
        max-width: 200px;
    }

    .floating-image-bottom {
        bottom: -50px;
        left: -50px;
        width: 60vw;
        max-width: 200px;
    }
}

@media (max-width: 480px) {
    body {
        font-size: 14px;
    }

    .header {
        font-size: 20px;
    }

    h1 {
        font-size: 1.6em;
    }

    .question p {
        font-size: 1em;
    }

    .option label {
        font-size: 0.9em;
        padding: 8px 12px;
    }

    .submit-container input[type="submit"],
    .submit-container button {
        font-size: 1em;
        padding: 8px 16px;
    }

    .floating-image-top,
    .floating-image-bottom {
        width: 50vw;
        max-width: 180px;
    }
}
</style>
</head>
<body>
    <div class="header">MyAttachment</div>
    <img src="vector-13png_1700130200_54679.png" alt="Top Floating Image" class="floating-image-top">
    <img src="vector-15png_1700141862_82973.png" alt="Bottom Floating Image" class="floating-image-bottom">
    <div class="container">
        <h1>Attachment Style Questionnaire</h1>
        <form id="attachmentForm">
            <div id="progressBar" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" style="width: 0%;"></div>
            <div id="questionContainer"></div>
            <div class="submit-container">
                <button type="button" id="prevButton" aria-label="Previous question">Previous</button>
                <button type="button" id="nextButton" aria-label="Next question">Next</button>
                <button type="submit" id="submitButton" style="display:none;">Submit</button>
            </div>
        </form>
    </div>
    <script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('attachmentForm');
    const questionContainer = document.getElementById('questionContainer');
    const prevButton = document.getElementById('prevButton');
    const nextButton = document.getElementById('nextButton');
    const submitButton = document.getElementById('submitButton');
    const progressBar = document.getElementById('progressBar');

    let currentQuestion = 0;
    let answers = JSON.parse(localStorage.getItem('attachmentAnswers')) || [];

    const questions = [
        { text: "I feel at ease in emotional relationships", style: "S" },
        { text: "I would like to be open to others but I feel that I can't trust other people", style: "F" },
        { text: "I feel uncomfortable when relationships with other people become close", style: "S", reverse: true },
        { text: "I would like to have close relationships with other people but I find it difficult to fully trust them", style: "F" },
        { text: "I prefer that others are independent of me and I am independent of them", style: "D" },
        { text: "I often wonder whether people like me", style: "P" },
        { text: "I avoid close ties", style: "S", reverse: true },
        { text: "I have the impression that usually I like others better than they like me", style: "P" },
        { text: "I trust other people and I like it when other people can rely on me", style: "S" },
        { text: "I am often afraid that other people don't like me", style: "P" },
        { text: "It is important to me to be independent", style: "D" },
        { text: "I find it easy to get engaged in close relationships with other people", style: "S" },
        { text: "I feel at ease in intimate relationships", style: "S" },
        { text: "I like to be self-sufficient", style: "D" },
        { text: "I don't worry whether people like me or not", style: "P" },
        { text: "I think it is important that people can rely on each other", style: "S" },
        { text: "I don't worry about being alone: I don't need other people that strongly", style: "D" },
        { text: "I am afraid that I will be deceived when I get too close with others", style: "F" },
        { text: "I usually find other people more interesting than myself", style: "P" },
        { text: "I trust that others will be there for me when I need them", style: "S" },
        { text: "I am wary to get engaged in close relationships because I am afraid to get hurt", style: "F" },
        { text: "It is important to me to know if others like me", style: "P" }
    ];

    function showQuestion(index) {
        const question = questions[index];
        questionContainer.innerHTML = `
            <div class="question" aria-live="polite">
                <p id="questionText">${index + 1}. ${question.text}</p>
                <div class="options-container" role="radiogroup" aria-labelledby="questionText">
                    ${['Strongly Agree', 'Agree', 'Neutral', 'Disagree', 'Strongly Disagree'].map((option, i) => `
                        <div class="option">
                            <input type="radio" id="q${index}-${i}" name="q${index}" value="${5 - i}" required 
                                ${answers[index] === 5 - i ? 'checked' : ''}>
                            <label for="q${index}-${i}">${option}</label>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
        updateProgressBar();
        updateButtonVisibility();

        // Smooth transition
        questionContainer.style.opacity = 0;
        setTimeout(() => {
            questionContainer.style.opacity = 1;
        }, 50);
    }

    function updateProgressBar() {
        const progress = ((currentQuestion + 1) / questions.length) * 100;
        progressBar.style.width = `${progress}%`;
        progressBar.setAttribute('aria-valuenow', progress);
    }

    function updateButtonVisibility() {
        prevButton.style.display = currentQuestion === 0 ? 'none' : 'inline-block';
        nextButton.style.display = currentQuestion === questions.length - 1 ? 'none' : 'inline-block';
        submitButton.style.display = currentQuestion === questions.length - 1 ? 'inline-block' : 'none';
    }

    function saveProgress() {
        localStorage.setItem('attachmentAnswers', JSON.stringify(answers));
        localStorage.setItem('currentQuestion', currentQuestion);
    }

    prevButton.addEventListener('click', () => {
        if (currentQuestion > 0) {
            currentQuestion--;
            showQuestion(currentQuestion);
        }
    });

    nextButton.addEventListener('click', () => {
        const selectedOption = document.querySelector(`input[name="q${currentQuestion}"]:checked`);
        if (selectedOption) {
            answers[currentQuestion] = parseInt(selectedOption.value);
            saveProgress();
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                showQuestion(currentQuestion);
            }
        } else {
            alert('Please answer the current question before proceeding.');
        }
    });

    submitButton.addEventListener('click', function(event) {
        event.preventDefault();
        const selectedOption = document.querySelector(`input[name="q${currentQuestion}"]:checked`);
        if (selectedOption) {
            answers[currentQuestion] = parseInt(selectedOption.value);
            if (answers.length === questions.length) {
                calculateScores();
            } else {
                alert('Please answer all questions before submitting.');
            }
        } else {
            alert('Please answer the current question before submitting.');
        }
    });

    function calculateScores() {
        let scores = { S: 0, F: 0, P: 0, D: 0 };
        let counts = { S: 0, F: 0, P: 0, D: 0 };

        questions.forEach((question, index) => {
            let value = answers[index];
            if (question.reverse) {
                value = 6 - value;
            }
            scores[question.style] += value;
            counts[question.style]++;
        });

        const means = {
            Secure: counts.S > 0 ? scores.S / counts.S : 0,
            Fearful: counts.F > 0 ? scores.F / counts.F : 0,
            Preoccupied: counts.P > 0 ? scores.P / counts.P : 0,
            Dismissing: counts.D > 0 ? scores.D / counts.D : 0
        };

        displayResults(means);
    }

    function displayResults(means) {
        const results = Object.entries(means).map(([style, score]) => ({ style, score }));
        results.sort((a, b) => b.score - a.score);
        const highestScore = results[0].score;
        const highestStyles = results.filter(r => r.score === highestScore).map(r => r.style);

        let resultsHTML = `
            <h2>Your Attachment Style Questionnaire Results are:</h2>
            <ul>
                ${results.map(r => `<li>${r.style}: ${r.score.toFixed(3)}</li>`).join('')}
            </ul>
            <p>Your Attachment Style${highestStyles.length > 1 ? 's are' : ' is'}:</p>
            <p><strong>${highestStyles.join(', ')}</strong></p>
            <button id="findOutButton" class="cta-button">Find Out About It</button>
            <button id="exportButton" class="secondary-button">Export Results</button>
        `;

        questionContainer.innerHTML = resultsHTML;

        document.getElementById('findOutButton').addEventListener('click', function() {
            window.location.href = 'AttachmentStyles.html';
        });

        document.getElementById('exportButton').addEventListener('click', function() {
            exportResults(means);
        });

        prevButton.style.display = 'none';
        nextButton.style.display = 'none';
        submitButton.style.display = 'none';
        progressBar.style.display = 'none';

        // Clear local storage
        localStorage.removeItem('attachmentAnswers');
        localStorage.removeItem('currentQuestion');
    }

    function exportResults(means) {
        const resultsText = Object.entries(means)
            .map(([style, score]) => `${style}: ${score.toFixed(3)}`)
            .join('\n');
        const blob = new Blob([resultsText], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'attachment_style_results.txt';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }

    // Keyboard navigation
    document.addEventListener('keydown', function(e) {
        if (e.key === 'ArrowLeft' && currentQuestion > 0) {
            prevButton.click();
        } else if (e.key === 'ArrowRight' && currentQuestion < questions.length - 1) {
            nextButton.click();
        }
    });

    // Initialize the first question or resume from saved progress
    currentQuestion = parseInt(localStorage.getItem('currentQuestion')) || 0;
    showQuestion(currentQuestion);
});
</script>
</body>
</html>
